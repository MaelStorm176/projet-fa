{% extends 'base.html.twig' %}

{% block title %}Hello NewRecetteController!{% endblock %}

{% block body %}
<a href="/all">Retour a la liste des recettes</a>
    <style>
        .rating {
            display: flex;
            flex-direction: row-reverse;
        }

        .rating>input {
            display: none
        }

        .rating>label {
            width: 1em;
            font-size: 30px;
            font-weight: 300;
            color: #FFD600;
            cursor: pointer
        }

        .rating>label::before {
            content: "\2605";
            position: absolute;
            opacity: 0
        }

        .rating>label:hover:before,
        .rating>label:hover~label:before {
            opacity: 1 !important
        }

        .rating>input:checked~label:before {
            opacity: 1
        }

        .rating:hover>input:checked~label:before {
            opacity: 0.4
        }

        .rating-submit {
            border-radius: 15px;
            color: #fff;
            height: 49px
        }

        .rating-submit:hover {
            color: #fff
        }
    </style>
    <p>{{recette.name}}</p>
    <div class="rating">
        {% if rating != [] and rating.rate == 5 %}
            <input type="radio" name="rating" value="5" id="5" checked onclick="rate({{recette.id}}, 5)">
            <label for="5">☆</label>
        {% else %}
            <input type="radio" name="rating" value="5" id="5" onclick="rate({{recette.id}}, 5)">
            <label for="5">☆</label> 
        {% endif %}
        {% if rating != [] and rating.rate == 4 %}
            <input type="radio" name="rating" value="4" id="4" checked onclick="rate({{recette.id}}, 4)">
            <label for="4">☆</label>
        {% else %}
            <input type="radio" name="rating" value="4" id="4" onclick="rate({{recette.id}}, 4)">
            <label for="4">☆</label> 
        {% endif %}
        {% if rating != [] and rating.rate == 3 %}
            <input type="radio" name="rating" value="3" id="3" checked onclick="rate({{recette.id}}, 3)">
            <label for="3">☆</label>
        {% else %}
            <input type="radio" name="rating" value="3" id="3" onclick="rate({{recette.id}}, 3)">
            <label for="3">☆</label> 
        {% endif %}
        {% if rating != [] and rating.rate == 2 %}
            <input type="radio" name="rating" value="2" id="2" checked onclick="rate({{recette.id}}, 2)">
            <label for="2">☆</label>
        {% else %}
            <input type="radio" name="rating" value="2" id="2" onclick="rate({{recette.id}}, 2)">
            <label for="2">☆</label> 
        {% endif %}
        {% if rating != [] and rating.rate == 2 %}
            <input type="radio" name="rating" value="1" id="1" checked onclick="rate({{recette.id}}, 1)">
            <label for="1">☆</label>
        {% else %}
            <input type="radio" name="rating" value="1" id="1" onclick="rate({{recette.id}}, 1)">
            <label for="1">☆</label> 
        {% endif %}
    </div>
    <div>
        {{ form_start(recetteForm) }}
            {{ form_row(recetteForm.content) }}
            {{ form_row(recetteForm.save) }}
        {{ form_end(recetteForm) }}
    </div>
    <div>
        <h2>Commentaires</h2>
        {% for comments in comment %}
            {% if comments.recette == recette %}
                <div>
                    <p>{{comments.user.email}}</p>
                    <p>{{comments.content}}</p>
                    <p>{{comments.createdAt | date("d/m/Y h:i:s")}}</p>
                </div>
            {% endif %}
        {% endfor %}
    </div>
    <script>
            function rate(id, value) {
                $.ajax({
                    type: 'post',
                    url: "/rate/"+id+"/"+value,
                    dataType: 'json',
                    success: function(json){
                        console.log("Rating good !");
                }});
            }
        </script>
{% endblock %}
